services:

  ## Docker Container Management
  ## https://wiki.serversatho.me/
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    restart: unless-stopped
    ports:
      - 8085:8000 # Portainer http
      - 44385:9443 # Portainer https
    volumes:
      - type: bind
        source: /var/run/docker.sock
        target: /var/run/docker.sock
      - type: bind 
        source: ${STORAGE}/configs/portainer
        target: /data

  ## Docker Log Viewer
  dozzle:
    container_name: dozzle
    image: amir20/dozzle:latest
    ports:
      - 8084:8080 # Dozzle
    restart: unless-stopped
    volumes:
      - type: bind
        source: /var/run/docker.sock
        target: /var/run/docker.sock

  ## Hard Drive Health Dashboard
  scrutiny:
    container_name: scrutiny
    restart: unless-stopped
    image: ghcr.io/analogj/scrutiny:master-omnibus
    privileged: true
    cap_add:
      - SYS_RAWIO
    ports:
      - 8083:8080 # Scrutiny webapp
      - 8086:8086 # Scrutiny influxDB admin
    volumes:
      - type: bind
        source: run/udev
        target: /run/udev
        read_only: true
      - type: bind
        source: /dev
        target: /dev
        read_only: true
      - type: bind 
        source: ${STORAGE}/configs/scrutiny
        target: /opt/scrutiny/config
      - type: bind 
        source: ${STORAGE}/configs/scrutiny/influxdb
        target: /opt/scrutiny/influxdb

  ## Heimdall - Homepage
  ## https://github.com/linuxserver/docker-heimdall
  heimdall:
    image: lscr.io/linuxserver/heimdall:latest
    container_name: heimdall
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${TIMEZONE}
      - ALLOW_INTERNAL_REQUESTS=true #optional
    volumes:
      - type: bind 
        source: ${STORAGE}/configs/heimdall
        target: /config
    ports:
      - 80:80 # Heimdall http
      - 443:443 # Heimdall https
    restart: unless-stopped
  
